# ============================================================================
# .htaccess CORRIGIDO para WordPress + LiteSpeed + Proxy Reverso
# Gente Networking - Landing Pages
# ============================================================================
# 
# INSTRUÇÕES DE USO:
# 1. Faça backup do seu .htaccess atual
# 2. Substitua TODO o conteúdo do .htaccess pela configuração abaixo
# 3. Salve o arquivo
# 4. Teste acessando https://gentenetworking.com.br/participe
#
# ============================================================================

# BEGIN Really Simple Security Redirect
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTP:CF-Visitor} '"scheme":"http"'
RewriteCond %{REQUEST_URI} !^/\.well-known/acme-challenge/
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
</IfModule>
# END Really Simple Security Redirect

# BEGIN LSCACHE
## LITESPEED WP CACHE PLUGIN - Do not edit the contents of this block! ##
<IfModule LiteSpeed>
RewriteEngine on
CacheLookup on
RewriteRule .* - [E=Cache-Control:no-autoflush]
RewritleRule litespeed/debug/.*\.log$ - [F,L]
RewriteRule \.litespeed_conf\.dat - [F,L]

### marker ASYNC start ###
RewriteCond %{REQUEST_URI} /wp-admin/admin-ajax\.php
RewriteCond %{QUERY_STRING} action=async_litespeed
RewriteRule .* - [E=noabort:1]
### marker ASYNC end ###

### marker DROPQS start ###
CacheKeyModify -qs:fbclid
CacheKeyModify -qs:gclid
CacheKeyModify -qs:utm*
CacheKeyModify -qs:_ga
### marker DROPQS end ###

</IfModule>
## LITESPEED WP CACHE PLUGIN - Do not edit the contents of this block! ##
# END LSCACHE

# BEGIN NON_LSCACHE
## LITESPEED WP CACHE PLUGIN - Do not edit the contents of this block! ##
## LITESPEED WP CACHE PLUGIN - Do not edit the contents of this block! ##
# END NON_LSCACHE

# BEGIN WordPress
# As diretrizes (linhas) entre "BEGIN WordPress" e "END WordPress" são
# geradas dinamicamente e só devem ser modificadas através de filtros do WordPress.
# Quaisquer alterações nas diretivas entre esses marcadores serão sobrescritas.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /

# ============================================================================
# EXCEÇÕES PARA LANDING PAGES - NÃO REMOVER!
# Estas regras impedem que o WordPress capture as rotas /participe e /gentehub
# permitindo que o proxy reverso funcione corretamente
# ============================================================================
RewriteRule ^participe(/.*)?$ - [L,PT]
RewriteRule ^gentehub(/.*)?$ - [L,PT]
# ============================================================================

RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress

# ============================================================================
# PROXY REVERSO PARA LANDING PAGES
# Redireciona /participe e /gentehub para o Cloudflare Pages
# ============================================================================
<IfModule mod_proxy.c>
    ProxyPreserveHost On
    SSLProxyEngine On
    
    # Landing page /participe
    ProxyPass /participe https://lps.gentenetworking.com.br/participe
    ProxyPassReverse /participe https://lps.gentenetworking.com.br/participe
    
    # Landing page /gentehub
    ProxyPass /gentehub https://lps.gentenetworking.com.br/gentehub
    ProxyPassReverse /gentehub https://lps.gentenetworking.com.br/gentehub
</IfModule>
# ============================================================================

# Wordfence WAF
<IfModule LiteSpeed>
</IfModule>
<IfModule lsapi_module>
</IfModule>
<Files ".user.ini">
<IfModule mod_authz_core.c>
	Require all denied
</IfModule>
<IfModule !mod_authz_core.c>
	Order deny,allow
	Deny from all
</IfModule>
</Files>
# END Wordfence WAF

# BEGIN Really Simple Security No Index
# As diretrizes (linhas) entre "BEGIN Really Simple Security No Index" e "END Really Simple Security No Index" são
# geradas dinamicamente e só devem ser modificadas através de filtros do WordPress.
# Quaisquer alterações nas diretivas entre esses marcadores serão sobrescritas.
# END Really Simple Security No Index

# BEGIN cPanel-generated php ini directives, do not edit
# Manual editing of this file may result in unexpected behavior.
# To make changes to this file, use the cPanel MultiPHP INI Editor (Home >> Software >> MultiPHP INI Editor)
# For more information, read our documentation (https://go.cpanel.net/EA4ModifyINI)
<IfModule php7_module>
</IfModule>
<IfModule lsapi_module>
</IfModule>
# END cPanel-generated php ini directives, do not edit
AddType application/x-httpd-php .html
